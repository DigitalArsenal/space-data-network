namespace orbpro.thirdparty.v1;

// Client-side license request used by third-party plugins tied to user accounts.
table ThirdPartyClientLicenseRequest {
  // Schema major version for compatibility checks.
  schema_version:ushort = 1;

  // Stable plugin identifier (reverse-dns or org scoped).
  plugin_id:string (required);

  // Plugin semantic version string.
  plugin_version:string (required);

  // Hash of account identifier (server canonical form), 32 bytes.
  account_id_hash:[ubyte] (required);

  // Request nonce generated by client runtime, 16 bytes.
  request_nonce:[ubyte] (required);

  // Ephemeral public key for wrapping response material.
  ephemeral_public_key:[ubyte] (required);

  // Optional opaque challenge token minted by broker.
  challenge_token:string;
}

root_type ThirdPartyClientLicenseRequest;
file_identifier "TPCR";
